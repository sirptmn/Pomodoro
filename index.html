<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pomodoro Timer</title>
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        @font-face {
            font-family: 'Smile';
            src: url('Smile.ttf') format('truetype');
        }

        body {
            background-color: #ffefb1;
            background-image: url(tomato2.jpg);
            background-size: auto;
            color: #333;
            font-family: 'Smile', 'Courier New', Courier, monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            background-color: white;
            border: 2px solid #333;
            border-radius: 10px;
            padding: 30px;
            width: 100%;
            max-width: 500px;
            box-shadow: 5px 5px 0px #aaaaaa;
        }

        .header { text-align: center; border-bottom: 2px dashed #ccc; padding-bottom: 15px; margin-bottom: 20px; }
        .header h1 { margin: 0; font-size: 24px; color: #d9534f; }
        .header p { margin: 5px 0 0 0; font-size: 14px; color: #555; }

        .timer-section { text-align: center; margin-bottom: 30px; }
        .modes { display: flex; justify-content: center; gap: 10px; margin-bottom: 15px; }
        
        .mode-btn { background-color: #eee; border: 1px solid #999; color: #333; font-family: inherit; padding: 8px 15px; cursor: pointer; border-radius: 5px; }
        .mode-btn:hover { background-color: #ddd; }
        
        .mode-btn.active { background-color: #5bc0de; color: white; border-color: #46b8da; font-weight: bold; }
        
        .time-display { font-size: 70px; font-weight: bold; margin: 15px 0; color: #333; }

        .start-btn { background-color: #5cb85c; color: white; font-size: 20px; font-family: inherit; border: 2px solid #4cae4c; border-radius: 5px; padding: 10px 30px; cursor: pointer; font-weight: bold; }
        .start-btn:hover { background-color: #449d44; }

        .tasks-section { background-color: #f9f9f9; border: 1px solid #ddd; padding: 15px; border-radius: 5px; }
        .task-input-container { display: flex; gap: 10px; margin-bottom: 15px; }
        .task-input { flex: 1; padding: 8px; border: 1px solid #ccc; border-radius: 3px; font-family: inherit; }
        .add-task-btn { background-color: #0275d8; color: white; border: 1px solid #025aa5; padding: 8px 15px; cursor: pointer; border-radius: 3px; font-family: inherit; }
        
        .color-picker { display: flex; gap: 10px; align-items: center; margin-bottom: 15px; justify-content: center; }
        .color-label { font-size: 14px; font-weight: bold; }
        .color-swatch { width: 25px; height: 25px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; transition: transform 0.2s; }
        .color-swatch:hover { transform: scale(1.1); }
        .color-swatch.selected { border-color: #333; box-shadow: 0 0 5px rgba(0,0,0,0.3); }

        .task-list { list-style-type: none; padding-left: 0; margin: 0; }
        .task-item { 
            margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; 
            padding: 10px; border: 1px solid #ddd; border-radius: 5px; background-color: white;
            transition: background-color 0.3s, color 0.3s;
        }
        
        .task-content { display: flex; align-items: center; gap: 10px; flex: 1; }
        .task-checkbox { width: 18px; height: 18px; cursor: pointer; }
        
        .task-item.completed { color: white; border-color: transparent; }
        .task-item.completed span { text-decoration: line-through; opacity: 0.8; }

        .delete-btn { background: #d9534f; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; font-family: inherit; }
        .delete-btn:hover { background: #c9302c; }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h1>‚è±Ô∏è Web Pomodoro Timer</h1>
        </div>

        <div class="timer-section">
            <div class="modes">
                <button class="mode-btn active" onclick="setMode('pomodoro', 25)" id="btn-pomodoro">Pomodoro</button>
                <button class="mode-btn" onclick="setMode('shortBreak', 5)" id="btn-shortBreak">Short Break</button>
                <button class="mode-btn" onclick="setMode('longBreak', 15)" id="btn-longBreak">Long Break</button>
            </div>
            
            <div class="time-display" id="time-display">25:00</div>
            
            <button class="start-btn" id="start-btn" onclick="toggleTimer()">START</button>
        </div>

        <div class="tasks-section">
            <h3 style="margin-top: 0; border-bottom: 1px solid #ddd; padding-bottom: 5px;">üìù My Todo List</h3>
            
            <div class="color-picker">
                <span class="color-label">Colour:</span>
                <div class="color-swatch selected" style="background-color: #5cb85c;" onclick="selectColor('#5cb85c', this)"></div>
                <div class="color-swatch" style="background-color: #f0ad4e;" onclick="selectColor('#f0ad4e', this)"></div>
                <div class="color-swatch" style="background-color: #5bc0de;" onclick="selectColor('#5bc0de', this)"></div>
                <div class="color-swatch" style="background-color: #d9534f;" onclick="selectColor('#d9534f', this)"></div>
                <div class="color-swatch" style="background-color: #a46497;" onclick="selectColor('#a46497', this)"></div>
            </div>

            <div class="task-input-container">
                <input type="text" id="new-task" class="task-input" placeholder="‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥...">
                <button class="add-task-btn" onclick="addTask()">Add</button>
            </div>

            <ul class="task-list" id="task-list"></ul>
        </div>
    </div>

    <script>
        let timer;
        let timeLeft = 25 * 60;
        let isRunning = false;

        const display = document.getElementById('time-display');
        const startBtn = document.getElementById('start-btn');
        const taskInput = document.getElementById('new-task');
        const taskList = document.getElementById('task-list');
        
        let currentSelectedColor = '#5cb85c';

        const alarmSound = new Audio('https://actions.google.com/sounds/v1/alarms/digital_watch_alarm_long.ogg');

        let tasks = JSON.parse(localStorage.getItem('my_pomodoro_tasks_v3')) || [];

        function saveTasksToStorage() {
            localStorage.setItem('my_pomodoro_tasks_v3', JSON.stringify(tasks));
        }

        function selectColor(colorCode, element) {
            currentSelectedColor = colorCode;
            document.querySelectorAll('.color-swatch').forEach(swatch => swatch.classList.remove('selected'));
            element.classList.add('selected');
        }

        function renderTasks() {
            taskList.innerHTML = '';
            
            tasks.forEach(function(task) {
                const li = document.createElement('li');
                
                li.className = `task-item ${task.completed ? 'completed' : ''}`;
                
                if (task.completed) {
                    li.style.backgroundColor = task.color;
                }

                li.innerHTML = `
                    <div class="task-content">
                        <input type="checkbox" class="task-checkbox" 
                               ${task.completed ? 'checked' : ''} 
                               onclick="toggleTaskCompletion(${task.id})">
                        <span>${task.text}</span>
                    </div>
                    <button class="delete-btn" onclick="deleteTask(${task.id})">Del</button>
                `;
                taskList.appendChild(li);
            });
        }

        function toggleTaskCompletion(taskId) {
            tasks = tasks.map(task => {
                if (task.id === taskId) {
                    const isNowCompleted = !task.completed; 
                    
                    if (isNowCompleted) {
                        confetti({
                            particleCount: 100,
                            spread: 70,
                            origin: { y: 0.6 }
                        });
                    }
                    
                    return { ...task, completed: isNowCompleted };
                }
                return task;
            });
            saveTasksToStorage();
            renderTasks();
        }

        function addTask() {
            const taskText = taskInput.value.trim();
            if (taskText === '') return;

            const newTask = {
                id: Date.now(),
                text: taskText,
                completed: false,
                color: currentSelectedColor
            };

            tasks.push(newTask);
            saveTasksToStorage();
            renderTasks();
            taskInput.value = '';
        }

        function deleteTask(taskId) {
            tasks = tasks.filter(task => task.id !== taskId);
            saveTasksToStorage();
            renderTasks();
        }

        taskInput.addEventListener('keypress', function (e) {
            if (e.key === 'Enter') { addTask(); }
        });

        function updateDisplay() {
            let minutes = Math.floor(timeLeft / 60);
            let seconds = timeLeft % 60;
            
            minutes = minutes < 10 ? '0' + minutes : minutes;
            seconds = seconds < 10 ? '0' + seconds : seconds;
            
            display.textContent = `${minutes}:${seconds}`;
        }

        function toggleTimer() {
            if (isRunning) {
                clearInterval(timer);
                startBtn.textContent = 'START';
                startBtn.style.backgroundColor = '#5cb85c';
                isRunning = false;
            } else {
                startBtn.textContent = 'PAUSE';
                startBtn.style.backgroundColor = '#f0ad4e';
                isRunning = true;
                
                alarmSound.load();
                
                timer = setInterval(() => {
                    timeLeft--;
                    updateDisplay();
                    
                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        startBtn.textContent = 'START';
                        startBtn.style.backgroundColor = '#5cb85c';
                        isRunning = false;
                        
                        alarmSound.play();
                        
                        setTimeout(()=> {
                            alert("‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡πâ‡∏ß! ‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ");
                            
                            alarmSound.pause();
                            alarmSound.currentTime = 0;
                        }, 10);
                    }
                }, 1000);
            }
        }

        function setMode(modeId, minutes) {
            clearInterval(timer);
            isRunning = false;
            startBtn.textContent = 'START';
            startBtn.style.backgroundColor = '#5cb85c';
            
            timeLeft = minutes * 60;
            updateDisplay();
            
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-${modeId}`).classList.add('active');
        }

        updateDisplay();
        renderTasks();
    </script>
</body>
</html>